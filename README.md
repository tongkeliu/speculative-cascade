# speculative-cascade
my own implementation of paper [Faster Cascades via Speculative Decoding](https://arxiv.org/pdf/2405.19261)
## environment
```
pip install -r requirements.txt
```
## start
```
python main.py --alpha 0.2 --gamma 50 --spec_def_rule token
```
## options
```
options:
  -h, --help            show this help message and exit
  --gamma GAMMA         tokens generated by SLM
  --alpha ALPHA         cost of switching to target model
  --approx_model {qwen3-0.6b}
                        a small model to approximate large one
  --target_model {qwen3-8b, qwen3-4b}
                        the target model
  --def_rule DEF_RULE   deferral rule for cascade
  --spec_def_rule {speculative,chow,optimal,token}
                        select the deferral rule
  --use_kvcache USE_KVCACHE
                        if use kvcache or not
  --top_k TOP_K         top_k value
  --top_p TOP_P         top_p value
  --temperature TEMPERATURE
                        temperature
  --max_length MAX_LENGTH
                        max length generated by model
  --prompt PROMPT
  --seed SEED           set seed to ensure reproduction
  --device DEVICE       GPU index
```